SRC_CLIENT	=	main.c				\
			gnl.c				\

SRC_LOADING	=	makefile_deco/loading.c

OBJ_CLIENT	=	$(SRC_CLIENT:.c=.o)
OBJ_SERVER	=	$(SRC_SERVER:.c=.o)
OBJ_LOADING	=	$(SRC_LOADING:.c=.o)

CLIENT		=	client/client
SERVER		=	server/server
NAME_LOADING	=	makefile_deco/loading

CFLAGS		=	`pkg-config --libs --cflags gtk+-2.0` -W -Werror -Wall -I./clients -I./server -o3

all:		lib $(CLIENT) $(SERVER)

$(CLIENT):	$(OBJ_CLIENT)
		@echo -e "\n > COMPILATION DES .C DU CLIENT EN COURS\n"
		gcc  -o $(CLIENT) $(OBJ_CLIENT) `pkg-config --libs --cflags gtk+-2.0` -I./client -lmy -L ./mylib
		@echo -e "\n > COMPILATION DES .C DU CLIENT TERMINEE"

$(SERVER):	$(OBJ_SERVER)
		@echo -e "\n > COMPILATION DES .C DU SERVER EN COURS\n"
		gcc  -o $(SERVER) $(OBJ_SERVER) `pkg-config --libs --cflags gtk+-2.0` -I./server -lmy -L ./mylib
		@echo -e "\n > COMPILATION DES .C DU SERVER TERMINEE"
		@cat makefile_deco/logins
		@cat makefile_deco/girl2

$(NAME_LIB):	$(OBJ_LOADING)
		cc -o $(NAME_LOADING) $(OBJ_LOADING)
		@echo -e "\n > COMPILATION DE LA LIB EN COURS\n"
		@./$(NAME_LOADING)
		ar rc $(NAME_LIB) $(OBJ_LIB)
		cp $(NAME_LIB) .
		ranlib $(NAME_LIB)
		@echo -e "\n > COMPILATION DE LA LIB TERMINEE"

lib:
		make fclean -C ./mylib
		make -C ./mylib

clean:
		@echo -e "\t->>> SUPPRESSION DES .o <<<-"
		rm -f $(OBJ_CLIENT)
		rm -f $(OBJ_SERVER)
		rm -f $(OBJ_LIB)
		rm -f $(OBJ_LOADING)

fclean:		clean
		@echo -e "\t->>> SUPPRESSION DE L'EXECUTABLE ET DE LA LIB <<<-"
		rm -f $(CLIENT)
		rm -f $(SERVER)
		rm -f $(NAME_LIB)
		rm -f $(NAME_LOADING)

re:		fclean all

.PHONY:		all lib clean fclean re